(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{120:function(e,t,n){},121:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(9),l=n.n(c),u=n(14),o=n(26),i=n(6),s=n.n(i),m=n(12),f=n(15),d=n(13),p=n(164),b=n(151),v=n(155),E=n(156),g=function(e){return function(t){t({type:"SET_USER",data:e})}},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return t.data;default:return e}},O={text:null,timerId:void 0},y={type:"NOTIFICATION",data:{text:null,className:"notification",timerId:void 0}},w=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return function(a){a({type:"NOTIFICATION",data:{text:e,className:t,timerId:setTimeout((function(){return a(y)}),1e3*n)}})}},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NOTIFICATION":return clearTimeout(e.timerId),t.data;default:return e}},k=function(e){var t=e.user,n=Object(u.b)(),a=Object(d.f)(),c=function(e){window.localStorage.removeItem("loggedBlogappUser");var r=t.name?t.name:t.username;n(g(null)),n(w("".concat(r," logged out"),"notification")),a.push("/")};return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{position:"static"},r.a.createElement(E.a,null,r.a.createElement(b.a,{color:"inherit",component:o.b,to:"/"},"blogs"),r.a.createElement(b.a,{color:"inherit",component:o.b,to:"/users"},"users"),r.a.createElement("em",null,r.a.createElement((function(){if(t){var e=t.name?t.name:t.username;return r.a.createElement(r.a.Fragment,null,e," logged-in",r.a.createElement(b.a,{onClick:c,color:"secondary"},"logout"))}return null}),null)))))},x=n(59),I=n(23),C=n.n(I),S="/api/blogs",N=null,T={getAll:function(){var e=Object(m.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.get(S);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getOne:function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.get("".concat(S,"/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){N="bearer ".concat(e)},create:function(){var e=Object(m.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:N}},e.next=3,C.a.post(S,t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),updateOne:function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.put("".concat(S,"/").concat(t.id),t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),addComment:function(){var e=Object(m.a)(s.a.mark((function e(t,n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.post("".concat(S,"/").concat(t.id,"/comments"),{comment:n});case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),remove:function(){var e=Object(m.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:N}},e.next=3,C.a.delete("".concat(S,"/").concat(t.id),n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},B=function(e){return function(){var t=Object(m.a)(s.a.mark((function t(n){var a,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,T.getOne(e);case 3:return(a=t.sent).likes+=1,t.next=7,T.updateOne(a);case 7:r=t.sent,n({type:"LIKE",data:r}),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),n(w(t.t0.response.data.error,"error",7)),console.log(t.t0.response.data.error);case 15:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}()},A=function(e){return function(){var t=Object(m.a)(s.a.mark((function t(n){var a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,T.getOne(e);case 3:return a=t.sent,t.next=6,T.remove(a);case 6:n({type:"REMOVE",data:a}),n(w("Blog ".concat(a.title," has been removed"),"notification")),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(0),n(w(t.t0.response.data.error,"error",7)),console.log(t.t0.response.data.error);case 14:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return e.concat(t.data).sort((function(e,t){return t.likes-e.likes}));case"ADD_BLOG":return e.concat(t.data);case"LIKE":var n=e.find((function(e){return e.id===t.data.id})),a=Object(x.a)({},n,{likes:n.likes+1});return e.map((function(e){return e.id!==t.data.id?e:a})).sort((function(e,t){return t.likes-e.likes}));case"COMMENT":var r=e.find((function(e){return e.id===t.data.id})),c=Object(x.a)({},r,{comments:t.data.comments});return e.map((function(e){return e.id!==t.data.id?e:c}));case"REMOVE":return e.filter((function(e){return e.id!==t.data.id}));default:return e}},D=n(157),L=n(51),F=n.n(L),M=n(52),R=n.n(M),_=function(e){var t=e.blog,n=e.currentUser,a=Object(u.b)();return r.a.createElement("div",{className:"blog"},r.a.createElement(o.b,{to:"/blogs/".concat(t.id)},"".concat(t.title,", by ").concat(t.author)),r.a.createElement(D.a,{onClick:function(){window.confirm("Do you really want to delete ".concat(t.title,", by ").concat(t.author,"?"))&&a(A(t.id))},"aria-label":"delete",color:"secondary",style:{display:n.username===t.user.username?"":"none",float:"right"}},r.a.createElement(F.a,null)),r.a.createElement("br",null),t.likes," like(s)",r.a.createElement("br",null),r.a.createElement(D.a,{onClick:function(){a(B(t.id))},variant:"contained",color:"primary"},r.a.createElement(R.a,null)))},G=function(e){var t=e.user,n=Object(u.c)((function(e){return e.blogs.sort((function(e,t){return t.likes-e.likes}))})),a=Object(u.b)();return n.map((function(e){return r.a.createElement(_,{key:e.id,blog:e,addLike:function(e){return a(B(e))},removeBlog:function(e){return a(A(e))},currentUser:t})}))},J=n(166),V=function(){var e=Object(u.c)((function(e){return e.notification})),t="notification"===e.className?"success":"error";return e.text?r.a.createElement(J.a,{severity:t,className:e.className},e.text):null},z=n(165),K={login:function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.post("api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},H=function(){var e=Object(a.useState)(""),t=Object(f.a)(e,2),n=t[0],c=t[1],l=Object(a.useState)(""),o=Object(f.a)(l,2),i=o[0],d=o[1],p=Object(u.b)(),v=function(){var e=Object(m.a)(s.a.mark((function e(t,n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,K.login({username:t,password:n});case 3:a=e.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(a)),T.setToken(a.token),p(g(a)),p(w("".concat(a.name?a.name:a.username," successfully logged in"),"notification")),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),p(w(e.t0.response.data.error,"error",10)),console.log(e.t0.response.data.error);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}();return r.a.createElement("form",{className:"loginForm",onSubmit:function(e){e.preventDefault(),v(n.toLocaleLowerCase(),i),c(""),d("")}},r.a.createElement("h2",null,"log in to blog application"),r.a.createElement("div",null,r.a.createElement(z.a,{label:"username",value:n,variant:"filled",onChange:function(e){return c(e.target.value)}})),r.a.createElement("br",null),r.a.createElement("div",null,r.a.createElement(z.a,{label:"password",value:i,variant:"filled",type:"password",onChange:function(e){return d(e.target.value)}})),r.a.createElement("br",null),r.a.createElement(b.a,{variant:"contained",color:"primary",type:"submit"},"login"),r.a.createElement("div",null,r.a.createElement("br",null),"Feel free to login with the following credentials:",r.a.createElement("ul",null,r.a.createElement("li",null,"Username: guest"),r.a.createElement("li",null,"Password: gimmieblogs")),"Also, please don't save anything too weird while you are here!"))},P=n(39),W=n.n(P),q=n(79),Q=n.n(q),X=Object(a.forwardRef)((function(e,t){var n=Object(a.useState)(!1),c=Object(f.a)(n,2),l=c[0],u=c[1],o={display:l?"none":""},i={display:l?"":"none"},s=function(){u(!l)};Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:s}}));var m={Create:r.a.createElement(W.a,null)};return r.a.createElement("div",{style:{paddingBottom:10}},r.a.createElement("div",{style:o},r.a.createElement(b.a,{onClick:s,startIcon:m[e.buttonStyle]},e.buttonLabel)),r.a.createElement("div",{style:i},e.children,r.a.createElement(b.a,{onClick:s,startIcon:r.a.createElement(Q.a,null),color:"secondary"},"cancel")))})),Y=function(){var e=Object(a.useRef)(),t=Object(u.b)(),n=Object(a.useState)(""),c=Object(f.a)(n,2),l=c[0],o=c[1],i=Object(a.useState)(""),d=Object(f.a)(i,2),p=d[0],v=d[1],E=Object(a.useState)(""),g=Object(f.a)(E,2),h=g[0],O=g[1];return r.a.createElement(X,{buttonLabel:"create new blog entry",buttonStyle:"Create",ref:e},r.a.createElement("div",null,r.a.createElement("h2",null,"Create new entry"),r.a.createElement("form",{onSubmit:function(n){var a;n.preventDefault(),e.current.toggleVisibility(),t((a={title:""===l?void 0:l,author:""===p?void 0:p,url:""===h?void 0:h},function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,T.create(a);case 3:n=e.sent,t({type:"ADD_BLOG",data:n}),t(w("A new blog ".concat(n.title," by ").concat(n.author," added"),"notification")),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),t(w(e.t0.response.data.error,"error",7)),console.log(e.t0.response.data.error);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}())),o(""),v(""),O("")}},r.a.createElement("div",null,r.a.createElement(z.a,{label:"title",value:l,onChange:function(e){return o(e.target.value)}})),r.a.createElement("div",null,r.a.createElement(z.a,{label:"author",value:p,onChange:function(e){return v(e.target.value)}})),r.a.createElement("div",null,r.a.createElement(z.a,{label:"url",value:h,type:"url",onChange:function(e){return O(e.target.value)}})),r.a.createElement(b.a,{type:"submit",startIcon:r.a.createElement(W.a,null)},"create entry"))))},Z=n(160),$=n(122),ee=n(161),te=n(162),ne=n(158),ae=n(159),re=n(163),ce=function(e){var t=e.username,n=e.numberOfBlogs,a=e.userId;return r.a.createElement(ne.a,null,r.a.createElement(ae.a,null,r.a.createElement(o.b,{to:"/users/".concat(a)},t)),r.a.createElement(ae.a,null,n))},le=function(e){var t=e.users;return r.a.createElement("div",{className:"userTable"},r.a.createElement("h2",null,"Users"),r.a.createElement(Z.a,{component:$.a},r.a.createElement(ee.a,null,r.a.createElement(te.a,null,r.a.createElement(ne.a,null,r.a.createElement(ae.a,null,"username"),r.a.createElement(ae.a,null,"blogs created"))),r.a.createElement(re.a,null,t.map((function(e){return r.a.createElement(ce,{key:e.id,username:e.username,numberOfBlogs:e.blogs.length,userId:e.id})}))))))},ue=function(e){var t=e.targetUser;return t?r.a.createElement("div",{className:"userDetails"},r.a.createElement("h2",null,t.name?t.name:t.username),r.a.createElement("h3",null,"added blogs"),r.a.createElement("ul",null,t.blogs.map((function(e){return r.a.createElement("li",{key:e.id},e.title)})))):r.a.createElement("h2",null,"user not found")},oe=function(e){var t=e.targetBlog,n=e.currentUser,c=Object(a.useState)(""),l=Object(f.a)(c,2),o=l[0],i=l[1],d=Object(u.b)();return t?r.a.createElement("div",{className:"blogDetails"},r.a.createElement(D.a,{onClick:function(){window.confirm("Do you really want to delete ".concat(t.title,", by ").concat(t.author,"?"))&&d(A(t.id))},variant:"contained","aria-label":"delete",color:"secondary",style:{display:n.username===t.user.username?"":"none",float:"right"}},r.a.createElement(F.a,null)),r.a.createElement("h2",null,t.title," by ",t.author),r.a.createElement("p",null,r.a.createElement("a",{href:t.url},t.url),r.a.createElement("br",null),t.likes," likes",r.a.createElement(D.a,{onClick:function(){d(B(t.id))}},r.a.createElement(R.a,null)),r.a.createElement("br",null),"added by ",t.user.name?t.user.name:t.user.username,r.a.createElement("br",null)),r.a.createElement("h3",null,"Comments"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),d(function(e,t){return function(){var n=Object(m.a)(s.a.mark((function n(a){var r,c;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,T.getOne(e);case 3:return(r=n.sent).comments.push(t),n.next=7,T.addComment(r,t);case 7:c=n.sent,a({type:"COMMENT",data:c}),n.next=15;break;case 11:n.prev=11,n.t0=n.catch(0),a(w(n.t0.response.data.error,"error",7)),console.log(n.t0.response.data.error);case 15:case"end":return n.stop()}}),n,null,[[0,11]])})));return function(e){return n.apply(this,arguments)}}()}(t.id,o)),i("")}},r.a.createElement(z.a,{label:"comment",value:o,onChange:function(e){return i(e.target.value)}}),r.a.createElement(D.a,null,r.a.createElement(W.a,null))),r.a.createElement("ul",null,t.comments.map((function(e,t){return r.a.createElement("li",{key:t},e)})))):r.a.createElement("h2",null,"blog not found")},ie={getAll:function(){var e=Object(m.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.get("/api/users");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getOne:function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.get("".concat("/api/users","/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},se=function(){var e=Object(a.useState)([]),t=Object(f.a)(e,2),n=t[0],c=t[1];Object(a.useEffect)((function(){(function(){var e=Object(m.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie.getAll();case 2:t=e.sent,c(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);var l=Object(d.g)("/users/:id"),o=l?n.find((function(e){return e.id===l.params.id})):null,i=Object(u.c)((function(e){return e.blogs})),b=Object(d.g)("/blogs/:id"),v=b?i.find((function(e){return e.id===b.params.id})):null,E=Object(u.c)((function(e){return e.user})),h=Object(u.b)();return Object(a.useEffect)((function(){h(function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[h]),Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogappUser");if(e){var t=JSON.parse(e);h(g(t)),T.setToken(t.token)}}),[h]),r.a.createElement(p.a,null,r.a.createElement("div",null,E&&r.a.createElement(k,{user:E}),r.a.createElement(V,null),r.a.createElement("div",null,!E&&r.a.createElement(H,null),E&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Blog App"),r.a.createElement(d.c,null,r.a.createElement(d.a,{path:"/users/:id"},r.a.createElement(ue,{targetUser:o})),r.a.createElement(d.a,{path:"/users"},r.a.createElement(le,{users:n})),r.a.createElement(d.a,{path:"/blogs/:id"},r.a.createElement(oe,{targetBlog:v,currentUser:E})),r.a.createElement(d.a,{path:"/"},r.a.createElement(Y,null),r.a.createElement(G,{user:E})))))))},me=n(35),fe=n(80),de=n(81),pe=Object(me.combineReducers)({blogs:U,notification:j,user:h}),be=Object(me.createStore)(pe,Object(de.composeWithDevTools)(Object(me.applyMiddleware)(fe.a)));n(120);l.a.render(r.a.createElement(o.a,null,r.a.createElement(u.a,{store:be},r.a.createElement(se,null))),document.getElementById("root"))},89:function(e,t,n){e.exports=n(121)}},[[89,1,2]]]);
//# sourceMappingURL=main.4a907543.chunk.js.map