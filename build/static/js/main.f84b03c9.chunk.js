(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{39:function(e,t,n){e.exports=n(70)},69:function(e,t,n){},70:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(17),u=n.n(c),o=n(4),l=n(11),i=n(1),s=n.n(i),m=n(2),d=n(7),p=n(3),f=function(e){return function(t){t({type:"SET_USER",data:e})}},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return t.data;default:return e}},v={text:null,timerId:void 0},g={type:"NOTIFICATION",data:{text:null,className:"notification",timerId:void 0}},E=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return function(r){r({type:"NOTIFICATION",data:{text:e,className:t,timerId:setTimeout((function(){return r(g)}),1e3*n)}})}},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NOTIFICATION":return clearTimeout(e.timerId),t.data;default:return e}},O=function(e){var t=e.user,n=Object(o.b)(),r=function(e){window.localStorage.removeItem("loggedBlogappUser");var r=t.name?t.name:t.username;n(f(null)),n(E("".concat(r," logged out"),"notification"))},c={paddingRight:5};return a.a.createElement("div",{style:{background:"lightgrey",position:"fixed",top:"0",overflow:"hidden",width:"100%"}},a.a.createElement(l.b,{style:c,to:"/"},"blogs"),a.a.createElement(l.b,{style:c,to:"/users"},"users"),a.a.createElement("em",null,a.a.createElement((function(){if(t){var e=t.name?t.name:t.username;return a.a.createElement(a.a.Fragment,null,e," logged-in ",a.a.createElement("button",{onClick:r},"logout"))}return null}),null)))},y=n(23),w=n(9),j=n.n(w),k="/api/blogs",x=null,I={getAll:function(){var e=Object(m.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.get(k);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getOne:function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.get("".concat(k,"/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){x="bearer ".concat(e)},create:function(){var e=Object(m.a)(s.a.mark((function e(t){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:x}},e.next=3,j.a.post(k,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),updateOne:function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.put("".concat(k,"/").concat(t.id),t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),addComment:function(){var e=Object(m.a)(s.a.mark((function e(t,n){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.post("".concat(k,"/").concat(t.id,"/comments"),{comment:n});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),remove:function(){var e=Object(m.a)(s.a.mark((function e(t){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:x}},e.next=3,j.a.delete("".concat(k,"/").concat(t.id),n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},C=function(e){return function(){var t=Object(m.a)(s.a.mark((function t(n){var r,a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,I.getOne(e);case 3:return(r=t.sent).likes+=1,t.next=7,I.updateOne(r);case 7:a=t.sent,n({type:"LIKE",data:a}),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),n(E(t.t0.response.data.error,"error",7)),console.log(t.t0.response.data.error);case 15:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}()},S=function(e){return function(){var t=Object(m.a)(s.a.mark((function t(n){var r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,I.getOne(e);case 3:return r=t.sent,t.next=6,I.remove(r);case 6:n({type:"REMOVE",data:r}),n(E("Blog ".concat(r.title," has been removed"),"notification")),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(0),n(E(t.t0.response.data.error,"error",7)),console.log(t.t0.response.data.error);case 14:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return e.concat(t.data).sort((function(e,t){return t.likes-e.likes}));case"ADD_BLOG":return e.concat(t.data);case"LIKE":var n=e.find((function(e){return e.id===t.data.id})),r=Object(y.a)({},n,{likes:n.likes+1});return e.map((function(e){return e.id!==t.data.id?e:r})).sort((function(e,t){return t.likes-e.likes}));case"COMMENT":var a=e.find((function(e){return e.id===t.data.id})),c=Object(y.a)({},a,{comments:t.data.comments});return e.map((function(e){return e.id!==t.data.id?e:c}));case"REMOVE":return e.filter((function(e){return e.id!==t.data.id}));default:return e}},B=function(e){var t=e.blog,n=e.currentUser,r=Object(o.b)();return a.a.createElement("div",{style:{paddingTop:10,paddingLeft:2,paddingBottom:10,border:"solid",borderWidth:1,marginBottom:5}},a.a.createElement(l.b,{to:"/blogs/".concat(t.id)},"".concat(t.title,", by ").concat(t.author)),a.a.createElement("button",{onClick:function(){window.confirm("Do you really want to delete ".concat(t.title,", by ").concat(t.author,"?"))&&r(S(t.id))},style:{display:n.username===t.user.username?"":"none",background:"red",color:"blue"}},"x"),a.a.createElement("br",null),t.likes," like(s)",a.a.createElement("button",{onClick:function(){r(C(t.id))}},"updoot"))},N=function(e){var t=e.user,n=Object(o.c)((function(e){return e.blogs.sort((function(e,t){return t.likes-e.likes}))})),r=Object(o.b)();return n.map((function(e){return a.a.createElement(B,{key:e.id,blog:e,addLike:function(e){return r(C(e))},removeBlog:function(e){return r(S(e))},currentUser:t})}))},A=function(){var e=Object(o.c)((function(e){return e.notification}));return e.text?a.a.createElement("div",{style:{border:"solid",padding:10,marginTop:30,borderWidth:1},className:e.className},e.text):null},U={login:function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.post("api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},L=function(){var e=Object(r.useState)(""),t=Object(d.a)(e,2),n=t[0],c=t[1],u=Object(r.useState)(""),l=Object(d.a)(u,2),i=l[0],p=l[1],b=Object(o.b)(),v=function(){var e=Object(m.a)(s.a.mark((function e(t,n){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,U.login({username:t,password:n});case 3:r=e.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(r)),I.setToken(r.token),b(f(r)),b(E("".concat(r.name?r.name:r.username," successfully logged in"),"notification")),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),b(E(e.t0.response.data.error,"error",10)),console.log(e.t0.response.data.error);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}();return a.a.createElement("form",{onSubmit:function(e){e.preventDefault(),v(n.toLocaleLowerCase(),i),c(""),p("")}},a.a.createElement("h2",null,"log in to blog application"),a.a.createElement("div",null,"username",a.a.createElement("input",{type:"text",value:n,name:"Username",onChange:function(e){return c(e.target.value)}})),a.a.createElement("div",null,"password",a.a.createElement("input",{type:"password",value:i,name:"Password",onChange:function(e){return p(e.target.value)}})),a.a.createElement("button",{type:"submit"},"login"),a.a.createElement("div",null,"Feel free to login with the following credentials:",a.a.createElement("ul",null,a.a.createElement("li",null,"Username: guest"),a.a.createElement("li",null,"Password: gimmieblogs")),"Also, please don't save anything too weird while you are here!"))},D=Object(r.forwardRef)((function(e,t){var n=Object(r.useState)(!1),c=Object(d.a)(n,2),u=c[0],o=c[1],l={display:u?"none":""},i={display:u?"":"none"},s=function(){o(!u)};return Object(r.useImperativeHandle)(t,(function(){return{toggleVisibility:s}})),a.a.createElement("div",{style:{paddingBottom:10}},a.a.createElement("div",{style:l},a.a.createElement("button",{onClick:s},e.buttonLabel)),a.a.createElement("div",{style:i},e.children,a.a.createElement("button",{onClick:s},"cancel")))})),F=function(){var e=Object(r.useRef)(),t=Object(o.b)(),n=Object(r.useState)(""),c=Object(d.a)(n,2),u=c[0],l=c[1],i=Object(r.useState)(""),p=Object(d.a)(i,2),f=p[0],b=p[1],v=Object(r.useState)(""),g=Object(d.a)(v,2),h=g[0],O=g[1];return a.a.createElement(D,{buttonLabel:"create new blog entry",ref:e},a.a.createElement("div",null,a.a.createElement("h2",null,"Create new entry"),a.a.createElement("form",{onSubmit:function(n){var r;n.preventDefault(),e.current.toggleVisibility(),t((r={title:""===u?void 0:u,author:""===f?void 0:f,url:""===h?void 0:h},function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,I.create(r);case 3:n=e.sent,t({type:"ADD_BLOG",data:n}),t(E("A new blog ".concat(n.title," by ").concat(n.author," added"),"notification")),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),t(E(e.t0.response.data.error,"error",7)),console.log(e.t0.response.data.error);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}())),l(""),b(""),O("")}},a.a.createElement("div",null,"title:",a.a.createElement("input",{type:"text",value:u,name:"Title",onChange:function(e){return l(e.target.value)}})),a.a.createElement("div",null,"author:",a.a.createElement("input",{type:"text",value:f,name:"Author",onChange:function(e){return b(e.target.value)}})),a.a.createElement("div",null,"url:",a.a.createElement("input",{type:"url",value:h,name:"Url",onChange:function(e){return O(e.target.value)}})),a.a.createElement("button",{type:"submit"},"create entry"))))},R=function(e){var t=e.username,n=e.numberOfBlogs,r=e.userId;return a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement(l.b,{to:"/users/".concat(r)},t)),a.a.createElement("td",null,n))},M=function(e){var t=e.users;return a.a.createElement(a.a.Fragment,null,a.a.createElement("h2",null,"Users"),a.a.createElement("table",null,a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",null,"username"),a.a.createElement("th",null,"blogs created"))),a.a.createElement("tbody",null,t.map((function(e){return a.a.createElement(R,{key:e.id,username:e.username,numberOfBlogs:e.blogs.length,userId:e.id})})))))},_=function(e){var t=e.targetUser;return t?a.a.createElement(a.a.Fragment,null,a.a.createElement("h2",null,t.name?t.name:t.username),a.a.createElement("h3",null,"added blogs"),a.a.createElement("ul",null,t.blogs.map((function(e){return a.a.createElement("li",{key:e.id},e.title)})))):a.a.createElement("h2",null,"user not found")},G=function(e){var t=e.targetBlog,n=e.currentUser,c=Object(r.useState)(""),u=Object(d.a)(c,2),l=u[0],i=u[1],p=Object(o.b)();return t?a.a.createElement("div",null,a.a.createElement("h2",null,t.title),a.a.createElement("p",null,a.a.createElement("a",{href:t.url},t.url),a.a.createElement("br",null),t.likes," likes ",a.a.createElement("button",{onClick:function(){p(C(t.id))}},"updoot"),a.a.createElement("br",null),"added by ",t.user.name?t.user.name:t.user.username,a.a.createElement("br",null),a.a.createElement("button",{onClick:function(){window.confirm("Do you really want to delete ".concat(t.title,", by ").concat(t.author,"?"))&&p(S(t.id))},style:{display:n.username===t.user.username?"":"none"}},"remove blog")),a.a.createElement("h3",null,"Comments"),a.a.createElement("form",{onSubmit:function(e){e.preventDefault(),p(function(e,t){return function(){var n=Object(m.a)(s.a.mark((function n(r){var a,c;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,I.getOne(e);case 3:return(a=n.sent).comments.push(t),n.next=7,I.addComment(a,t);case 7:c=n.sent,r({type:"COMMENT",data:c}),n.next=15;break;case 11:n.prev=11,n.t0=n.catch(0),r(E(n.t0.response.data.error,"error",7)),console.log(n.t0.response.data.error);case 15:case"end":return n.stop()}}),n,null,[[0,11]])})));return function(e){return n.apply(this,arguments)}}()}(t.id,l)),i("")}},a.a.createElement("input",{type:"text",value:l,name:"Comment",onChange:function(e){return i(e.target.value)}}),a.a.createElement("button",null,"add comment")),a.a.createElement("ul",null,t.comments.map((function(e,t){return a.a.createElement("li",{key:t},e)})))):a.a.createElement("h2",null,"blog not found")},J={getAll:function(){var e=Object(m.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.get("/api/users");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getOne:function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.get("".concat("/api/users","/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},V=function(){var e=Object(r.useState)([]),t=Object(d.a)(e,2),n=t[0],c=t[1];Object(r.useEffect)((function(){(function(){var e=Object(m.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J.getAll();case 2:t=e.sent,c(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]);var u=Object(p.f)("/users/:id"),l=u?n.find((function(e){return e.id===u.params.id})):null,i=Object(o.c)((function(e){return e.blogs})),b=Object(p.f)("/blogs/:id"),v=b?i.find((function(e){return e.id===b.params.id})):null,g=Object(o.c)((function(e){return e.user})),E=Object(o.b)();return Object(r.useEffect)((function(){E(function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[E]),Object(r.useEffect)((function(){var e=window.localStorage.getItem("loggedBlogappUser");if(e){var t=JSON.parse(e);E(f(t)),I.setToken(t.token)}}),[E]),a.a.createElement("div",null,a.a.createElement(O,{user:g}),a.a.createElement(A,null),a.a.createElement("div",null,!g&&a.a.createElement(L,null),g&&a.a.createElement(a.a.Fragment,null,a.a.createElement("h2",null,"Blog App"),a.a.createElement(p.c,null,a.a.createElement(p.a,{path:"/users/:id"},a.a.createElement(_,{targetUser:l})),a.a.createElement(p.a,{path:"/users"},a.a.createElement(M,{users:n})),a.a.createElement(p.a,{path:"/blogs/:id"},a.a.createElement(G,{targetBlog:v,currentUser:g})),a.a.createElement(p.a,{path:"/"},a.a.createElement(F,null),a.a.createElement(N,{user:g}))))))},W=n(13),z=n(37),K=n(38),P=Object(W.combineReducers)({blogs:T,notification:h,user:b}),H=Object(W.createStore)(P,Object(K.composeWithDevTools)(Object(W.applyMiddleware)(z.a)));n(69);u.a.render(a.a.createElement(l.a,null,a.a.createElement(o.a,{store:H},a.a.createElement(V,null))),document.getElementById("root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.f84b03c9.chunk.js.map